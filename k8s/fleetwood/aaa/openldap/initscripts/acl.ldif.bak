# We use posixGroups so group.exact will not work. We need expansion!
dn: olcDatabase={2}mdb,cn=config
changetype: modify
add: olcAccess
olcAccess: to *
  by set.expand="([uid=] + ([cn=ldap-admin,ou=groups,dc=cummings-online,dc=ca]
 )/memberUid + [,ou=users,dc=cummings-online,dc=ca])/entryDN & user" write
  by * break

dn: olcDatabase={2}mdb,cn=config
changetype: modify
add: olcAccess
olcAccess: to attrs=userPassword
  by set.expand="([uid=] + ([cn=admin,ou=groups,dc=cummings-online,dc=ca]
 )/memberUid + [,ou=users,dc=cummings-online,dc=ca])/entryDN & user" write
  by set.expand="([uid=] + ([cn=hr,ou=groups,dc=cummings-online,dc=ca]
 )/memberUid + [,ou=users,dc=cummings-online,dc=ca])/entryDN & user" write
  by self write
  by dn.children="ou=system,dc=cummings-online,dc=ca" read
  by anonymous auth

dn: olcDatabase={2}mdb,cn=config
changetype: modify
add: olcAccess
olcAccess: to attrs=telephoneNumber,mobile
  by set.expand="([uid=] + ([cn=hr,ou=groups,dc=cummings-online,dc=ca]
 )/memberUid + [,ou=users,dc=cummings-online,dc=ca])/entryDN & user" write
  by self write
  by users read

dn: olcDatabase={2}mdb,cn=config
changetype: modify
add: olcAccess
olcAccess: to *
  by set="user/uidNumber & [cn=reader,ou=groups,dc=cummings-online,dc=ca]/memb
 erUid" read

